alter table antm_cs_wgs_work add (managerid varchar2(8), managername varchar2(64));

CREATE OR REPLACE FORCE EDITIONABLE VIEW "SC731_SIT_DATA2"."VW_SC_CSMANAGERINVENTORY"(
	"CAPARENTID",
	"PYID",
	"WOCREATEDATETIME",
	"PXCREATEOPERATOR",
	"PXCREATEOPNAME",
	"PYSTATUSWORK",
	"HCCUSTOMERTYPE",
	"INTERACTIONTYPE",
	"PYLABEL",
	"MANAGERID",
	"MANAGERNAME",
	"PXREFOBJECTKEY",
	"PXASSIGNEDOPERATORID",
	"PXASSIGNEDUSERNAME",
	"CURRENTWB",
	"CURRENTWL",
	"PXCREATEDATETIME",
	"PZINSKEY"
)AS
	SELECT A.CAPARENTID,
	       A.PYID,
	       A.PXCREATEDATETIME,
	       A.PXCREATEOPERATOR,
	       A.PXCREATEOPNAME,
	       A.PYSTATUSWORK,
	       A.HCCUSTOMERTYPE,
	       A.INTERACTIONTYPE,
	       A.PYLABEL,
	       A.MANAGERID,
	       A.MANAGERNAME,
	       A.PZINSKEY,
	       B.PXASSIGNEDOPERATORID,
	       B.PXASSIGNEDUSERNAME,
	       B.CURRENTWB,
	       B.CURRENTWL,
	       B.PXCREATEDATETIME,
	       B.PZINSKEY
	FROM ANTM_CS_WGS_WORK A
	LEFT JOIN(
		SELECT XX.PXREFOBJECTKEY,
		       XX.PXASSIGNEDOPERATORID,
		       YY.PYLABEL   AS PXASSIGNEDUSERNAME,
		       YY.PYLABEL   AS CURRENTWB,
		       '' AS CURRENTWL,
		       XX.PXCREATEDATETIME,
		       XX.PZINSKEY
		FROM PC_ASSIGN_WORKBASKET   XX
		LEFT JOIN PR_DATA_ADMIN          YY ON XX.PXASSIGNEDOPERATORID = YY.PYWORKBASKET
		                              AND YY.PXOBJCLASS = 'Data-Admin-WorkBasket'
		UNION
		SELECT PXREFOBJECTKEY,
		       PXASSIGNEDOPERATORID,
		       PXASSIGNEDUSERNAME,
		       '' AS CURRENTWB,
		       PXASSIGNEDUSERNAME AS CURRENTWL,
		       PXCREATEDATETIME,
		       PZINSKEY
		FROM PC_ASSIGN_WORKLIST
	)B ON A.PZINSKEY = B.PXREFOBJECTKEY;